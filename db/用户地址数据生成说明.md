# 用户地址数据生成说明

## 生成结果

✅ **成功为20个用户生成了36个地址**

### 数据统计

- **总用户数**: 20个
- **总地址数**: 36个
- **默认地址数**: 20个（每个用户至少1个）
- **平均每个用户地址数**: 1.8个

### 地址分布

| 地址数量 | 用户数 | 说明 |
|---------|--------|------|
| 1个地址 | 11个用户 | 只有默认地址 |
| 2个地址 | 5个用户 | 1个默认 + 1个普通地址 |
| 3个地址 | 4个用户 | 1个默认 + 2个普通地址 |

## 地址数据特点

### 1. 地址信息完整性

每个地址包含：
- ✅ **收货人**: 使用用户的真实姓名
- ✅ **省市区**: 完整的省市区三级信息（包含ID和名称）
- ✅ **详细地址**: 街道、门牌号、楼栋、房间号
- ✅ **邮编**: 根据省份生成合理的邮编
- ✅ **手机号**: 70%使用用户手机号，30%生成新手机号
- ✅ **默认地址**: 每个用户第一个地址为默认地址

### 2. 地区分布

地址覆盖以下主要城市：
- **北京市**: 东城区、朝阳区、海淀区、丰台区等
- **上海市**: 黄浦区、徐汇区、长宁区等
- **广东省**: 广州市（荔湾区、越秀区、海珠区）、深圳市（罗湖区、福田区）
- **浙江省**: 杭州市（上城区、拱墅区）
- **江苏省**: 南京市（玄武区、秦淮区）
- **四川省**: 成都市（锦江区、青羊区）
- **湖北省**: 武汉市（江岸区、江汉区）

### 3. 数据示例

**用户：朱霞（温暖靓700）** - 3个地址
1. **默认地址**: 北京市朝阳区 - 人民巷160号广场136号1179室
2. **普通地址**: 湖北省武汉市江汉区 - 科技大道11号公寓30号846室
3. **普通地址**: 浙江省杭州市上城区 - 人民路927号广场85号1411室

## 生成的文件

- **`generate_user_addresses.py`** - 地址数据生成脚本
- **`insert_user_addresses.sql`** - 生成的SQL插入语句

## 数据验证

### 验证结果

✅ 所有20个用户都有地址  
✅ 每个用户至少有一个默认地址  
✅ 地址信息完整（省市区、详细地址、邮编、手机号）  
✅ 中文显示正常（UTF-8编码）  
✅ 地址状态正常（status=1）  

### 验证SQL

```sql
-- 查看每个用户的地址数量
SELECT u.user_id, u.nick_name, COUNT(a.addr_id) as addr_count, 
       SUM(CASE WHEN a.common_addr = 1 THEN 1 ELSE 0 END) as default_count 
FROM tz_user u 
LEFT JOIN tz_user_addr a ON u.user_id = a.user_id 
WHERE u.user_mail LIKE 'user%' 
GROUP BY u.user_id, u.nick_name;

-- 查看地址详情
SELECT addr_id, user_id, receiver, province, city, area, addr, mobile, common_addr 
FROM tz_user_addr 
WHERE user_id IN (SELECT user_id FROM tz_user WHERE user_mail LIKE 'user%')
ORDER BY user_id, common_addr DESC;
```

## 使用说明

### 重新生成地址数据

如果需要重新生成不同数据的地址：

```bash
cd /root/cb/mall4j/db
python3 generate_user_addresses.py > insert_user_addresses.sql
```

### 执行SQL插入

```bash
# 使用docker执行（推荐）
cat insert_user_addresses.sql | docker exec -i mall4j-mysql mysql -uroot -proot --default-character-set=utf8mb4 yami_shops

# 或直接mysql命令
mysql -uroot -proot --default-character-set=utf8mb4 yami_shops < insert_user_addresses.sql
```

## 下一步

现在用户地址数据已准备就绪，可以：

1. ✅ **创建订单**: 用户可以使用这些地址创建订单
2. ✅ **测试订单流程**: 测试订单创建、支付、发货等流程
3. ✅ **生成订单数据**: 基于这些地址生成测试订单数据

## 注意事项

1. **默认地址**: 每个用户的第一个地址自动设置为默认地址（common_addr=1）
2. **地址唯一性**: 地址ID自动递增，不会冲突
3. **用户关联**: 所有地址都正确关联到对应的用户ID
4. **数据完整性**: 所有必填字段都已填充，符合数据库约束

## 数据质量

- ✅ **真实性**: 使用真实的省市区数据
- ✅ **合理性**: 邮编、手机号、地址格式都符合规范
- ✅ **多样性**: 覆盖多个省份和城市
- ✅ **完整性**: 所有字段都有值，无NULL值（除可选字段）

地址数据已准备完毕，可以开始构造订单数据了！

