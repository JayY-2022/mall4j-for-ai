<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yami.shop.dao.McpBindingMapper">

    <select id="listByPrincipal" resultType="com.yami.shop.bean.model.McpBinding">
        SELECT * FROM mcp_bindings 
        WHERE principal_type = #{principalType} AND principal_id = #{principalId} AND status = 1
    </select>

    <select id="checkBinding" resultType="com.yami.shop.bean.model.McpBinding">
        SELECT * FROM mcp_bindings 
        WHERE principal_type = #{principalType} 
          AND principal_id = #{principalId}
          AND server_id = #{serverId}
          AND tool_name = #{toolName}
          AND status = 1
        LIMIT 1
    </select>

    <select id="getByAlias" resultType="com.yami.shop.bean.model.McpBinding">
        SELECT * FROM mcp_bindings 
        WHERE principal_type = #{principalType} 
          AND principal_id = #{principalId}
          AND alias = #{alias}
          AND status = 1
        LIMIT 1
    </select>

</mapper>

